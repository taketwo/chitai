<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chitai - Controller</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,400;0,600;1,400;1,600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/web/styles.css" />
    <script src="/web/debug.js"></script>
    <script src="/web/websocket.js"></script>
    <script src="/web/controller/controller.js"></script>
    <script defer src="/web/vendor/alpine.min.js"></script>
  </head>
  <body class="controller">
    <div class="container" x-data="controllerApp()" x-init="init()">
      <div x-ref="status" class="status"></div>

      <div class="session-controls">
        <button
          x-show="!sessionActive"
          :disabled="!connected"
          @click="startSession"
        >
          Start session
        </button>
        <button
          x-show="sessionActive"
          :disabled="!connected"
          @click="endSession"
        >
          End session
        </button>
      </div>

      <div class="controls" x-show="hasWords">
        <button
          class="back-btn"
          :disabled="!sessionActive || isCompleted"
          @click="advanceWord(-1)"
        >
          ‚Üê
        </button>
        <div
          x-ref="currentWord"
          class="current-word"
          x-text="currentWord"
        ></div>
        <button
          class="advance-btn"
          :class="{ 'next-item': isNextItemMode }"
          :disabled="!sessionActive || (isCompleted && queue.length === 0)"
          @click="advance"
          x-text="advanceButtonLabel"
        ></button>
      </div>

      <div class="input-group">
        <textarea
          x-model="textInput"
          placeholder="Enter text..."
          @keydown.enter.prevent="handleEnter"
        ></textarea>
        <div class="button-group">
          <button
            :disabled="!sessionActive || !textInput.trim() || isCompleted"
            @click="submitToQueue"
          >
            Enqueue
          </button>
          <button
            :disabled="!sessionActive || !textInput.trim() || !isCompleted"
            @click="submitAndShow"
          >
            Show
          </button>
        </div>
      </div>
    </div>
  </body>
</html>
